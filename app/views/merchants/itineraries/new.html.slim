.flex.flex-col.lg:flex-row
  .lg:w-1/3.overflow-y-auto.space-y-4.p-3 class="lg:h-[calc(100vh-80px)]"
    .flex.items-center.justify-between.print:hidden
      p.flex.items-center.uppercase.font-bold.gap-2
        = t('.title')
        = lucide_icon 'car', class: 'inline-flex'

      = link_to merchant_path(@merchant), title: t('.back_to_merchant'), class: 'btn btn-square btn-sm' do
        = lucide_icon 'x'

    article.space-y-4
      = simple_form_for :itinerary,
                        url: merchant_itinerary_path(@merchant, debug: params[:debug] == 'true'),
                        html: { \
                          class: 'flex flex-col gap-3 justify-between',
                          data: { \
                            controller: :address,
                            address_search_url_value: addresses_search_path,
                            action: 'turbo:submit-start->address#disableInputs turbo:submit-end->address#enableInputs' \
                          } \
                        } do |f|

        details.collapse.collapse-arrow.bg-base-200.border.border-base-content/20 open="open"
          summary.collapse-title.font-semibold.text-primary
            = t('.start_address')

          .collapse-content.space-y-3
            = f.input :my_address,
                      required: false,
                      label_html: { class: 'mb-2' },
                      wrapper_html: { class: 'auto-search-wrapper' },
                      input_html: { \
                        class: 'mb-1',
                        data: { \
                          address_target: :input,
                        } \
                      }

            = f.input :use_my_ip, as: :boolean,
                      input_html: { \
                        data: { \
                          address_target: :ip,
                          action: 'change->address#toggleInputAddress' \
                        } \
                      }

            = f.input :detailed_steps, as: :boolean,
                      input_html: { \
                        data: { \
                          address_target: 'detailedSteps',
                          action: 'change->address#rememberDetailedStepsChoice' \
                        } \
                      }

        = lucide_icon 'move-left', class: 'mx-auto w-12 h-12 -rotate-90 bg-primary text-primary-content rounded-full p-1'

        details.collapse.collapse-arrow.bg-base-200.border.border-base-content/20 open="open"
          summary.collapse-title
            p.mb-2.font-semibold.text-primary= t('.end_address')
            .flex.items-center.gap-2
              = render 'logo_or_initials', model: @merchant
              div
                p.font-bold= @merchant.name
                - if @merchant.full_address
                  p= @merchant.full_address
                  p.badge.badge-secondary= @merchant.friendly_category

          #map_details.collapse-content.space-y-3

        = f.button :submit, t('search'),
                    class: 'btn btn-success',
                    data: { \
                      address_target: :submit, turbo_submits_with: '...' \
                    }

  = render 'merchants/map', merchant: @merchant
